!function(e,t){if("function"==typeof define&&define.amd)define(["module","exports"],t);else if("undefined"!=typeof exports)t(module,exports);else{var n={exports:{}};t(n,n.exports),e.mango=n.exports}}(this,function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){function e(){return document.querySelectorAll(l)}function t(e){var t=e.getBoundingClientRect(),n=t.top,o=t.left,i=t.width,r=t.height,a=e.cloneNode(),s=window.pageYOffset||0,d=window.pageXOffset||0;return a.style.position="absolute",a.style.top=n+s+"px",a.style.left=o+d+"px",a.style.width=i+"px",a.style.height=r+"px",a}function i(){var e=document.createElement("div");return e.classList.add("mango-overlay"),e.style.backgroundColor=f,e}function r(e){if(e.preventDefault(),e.target){a(e.target)}else a(origin).out(150)}function a(e){function n(){function t(){h||(h=!0,document.body.classList.remove("mango--open"),i.style.transform="none",i.removeEventListener("click",n()),r=function t(){e.style.visibility="visible",i.remove(),p.remove(),i.classList.remove("mango-image--open"),h=!1,i.removeEventListener("transitionend",t)},i.addEventListener("transitionend",r),document.removeEventListener("keydown",a),document.removeEventListener("scroll",d))}var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;o>0?setTimeout(t,o):t()}if(e){h=!0;var o=window.pageYOffset||0,i=t(e);document.body.appendChild(p),document.body.appendChild(i),requestAnimationFrame(function(){document.body.classList.add("mango--open")}),e.style.visibility="hidden",i.classList.add("mango-image--open");var r=function e(){i.addEventListener("click",function(){h=!1,n()}),window.addEventListener("resize",function(){h=!1,n()}),p.addEventListener("click",function(){h=!1,n()}),i.removeEventListener("transitionend",e)},a=function(){m.includes(event.keyCode)&&(h=!1,n())},d=function(){var e=window.pageYOffset||0;Math.abs(o-e)>50&&(h=!1,n(150))};if(i.addEventListener("transitionend",r),document.addEventListener("keydown",a),document.addEventListener("scroll",d),e.dataset.src){var c=function(e){return new Promise(function(t,n){var o=new Image;o.src=e,o.onload=t,o.onerror=n})},u=function(e,t){e.src=t;var n=setInterval(function(){clearInterval(n),e.style.transform=s(e)},20)};(function(t){var n=t.dataset.src;return c(n).then(function(){return u(t,n)}).catch(function(){return i.style.transform=s(e)})})(i)}else i.style.transform=s(e)}}function s(e){var t={width:window.innerWidth,height:window.innerHeight,left:0,top:0,right:0,bottom:0},n=t.width-2*v,o=t.height-2*v,i=e,r=i.naturalWidth,a=void 0===r?n:r,s=i.naturalHeight,d=void 0===s?o:s,c=i.getBoundingClientRect(),u=c.top,l=c.left,f=c.width,m=c.height,g=Math.min(a,n)/f,p=Math.min(d,o)/m,h=Math.min(g,p)||1;return"scale("+h+") translate3d("+((n-f)/2-l+v+t.left)/h+"px,\n       "+((o-m)/2-u+v+t.top)/h+"px, 0)"}function d(e){Array.from(e).forEach(function(e){e.classList.add("mango-image"),e.addEventListener("click",function(e){r(e)})})}var c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=n({},o,c),l=u.selector,f=u.background,v=u.margin,m=u.interruptKeys,g=e(),p=i(),h=!1;return d(g)};var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},o={selector:"[data-mango]",background:"white",margin:50,interruptKeys:[27,37,39]};e.exports=t.default});